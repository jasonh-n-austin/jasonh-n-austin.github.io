
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>BDD / ATDD for your Agile REST API, part 2 - Pragmatic API</title>
  <meta name="author" content="Jason Harmon">
  <link rel="author" href="humans.txt">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  
    
  
  <meta name="description" content="Part 1: http://pragmaticapi.com/2013/01/12/bdd-atdd-for-your-agile-rest-api/ I recently covered how BDD principles can provide a great touch stone &hellip;">
  
  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jasonh-n-austin.github.io/2013/01/21/bdd-atdd-for-your-agile-rest-api-part-2/">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Cantarell' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Pragmatic API" type="application/atom+xml">
  <meta name="og:type" content="website" />
  <meta name="og:site_name" content="Pragmatic API" />
  <meta name="og:title" content="BDD / ATDD for your Agile REST API, part 2" />
  <meta name="og:description" content="Part 1: http://pragmaticapi.com/2013/01/12/bdd-atdd-for-your-agile-rest-api/ I recently covered how BDD principles can provide a great touch stone &hellip;" />
  <meta name="og:url" content="http://jasonh-n-austin.github.io/2013/01/21/bdd-atdd-for-your-agile-rest-api-part-2/"/>
  <meta name="url" content="http://jasonh-n-austin.github.io/2013/01/21/bdd-atdd-for-your-agile-rest-api-part-2/">
  
  <meta name="subject" content="Testing Automation"/>
  <meta name="category" content="Testing Automation"/>
  
  <meta name="distribution" content="global">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39563304-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <nav role="navigation"><div class="navbar">
  <div class="navbar-inner">
    <a class="brand" href="/">Pragmatic API</a>
    <ul class="nav">
      <li><a href="/blog/archives">Blog</a></li>
      
      <li>
        <a href="/about">
          About
        </a>
      </li>
      
      <li>
        <a href="https://github.com/jasonh-n-austin">
          Code
        </a>
      </li>
      
    </ul>
    <ul class="nav" data-subscription="rss">
      <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
      
    </ul>
      
    <form class="navbar-form" action="http://google.com/search" method="get">
      <fieldset role="search">
        <input type="hidden" name="q" value="site:jasonh-n-austin.github.io" />
        <input class="span2" type="text" name="q" results="0" placeholder="Search"/>
      </fieldset>
    </form>
      
    
  </div>
</div>
</nav>
  <div class="wrapper_single">
    <div class="container">
      <article class="span8 offset2" role="article">
        <div class="article-format">

  <header>
    
      <h1 class="entry-title">BDD / ATDD for Your Agile REST API, Part 2</h1>
    
    
      <p class="meta">
        
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/111160376507741662259?rel=author"><span class="fn">jhrmn</span></a></span>
  

 - 
        








  


<time datetime="2013-01-21T00:30:27-06:00" pubdate data-updated="true">Jan 21<span>st</span>, 2013</time> - 
        

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/testing-automation/'>Testing Automation</a>
  
</span>


        
      </p>
    
  </header>


  <div class="entry-content"><p>Part 1: <a href="http://pragmaticapi.com/2013/01/12/bdd-atdd-for-your-agile-rest-api/">http://pragmaticapi.com/2013/01/12/bdd-atdd-for-your-agile-rest-api/</a></p>

<p>I recently covered how BDD principles can provide a great touch stone for acceptance testing in REST-based API platforms. In this brief followup, I&rsquo;ll show how the Cucumber-JVM framework provides all of the same functionality that we saw in .NET&rsquo;s SpecFlow, using the Groovy programming language.</p>

<!-- more -->


<p>Code for this example can be found on <a href="https://github.com/jasonh-n-austin/TwitterRestTestsGroovy">Github</a>. This should provide you with a working example of BDD testing the Twitter API using Cucumber-JVM, Gradle, and Groovy.</p>

<p>Much like the CLR in .NET, we can use the JVM to provide access to a variety of programming languages. JUnit tests can be developed with Cucumber-JVM, looking almost just like the NUnit-based SpecFlow tests in Part 1. However, this example will show how JUnit, and thereby, any unit testing framework, doesn&rsquo;t necessarily need to be utilized.</p>

<p>Using groovy command-line based invocation of Cucumber tests can be very useful in scenarios where there is interoperability with other Groovy-based tools, namely SoapUI (commonly used in QA web services testing). It is easily possible to create classes which encapsulate the logic necessary to test your API, providing hooks for your Cucumber tests alongside SoapUI, or any other Groovy-based tools.</p>

<p>It is easily arguable that Groovy is well suited for this task. Groovy has some great features like the built in JsonSlurper, great library support (such as the excellent utility <a href="http://groovy.codehaus.org/modules/http-builder/doc/rest.html">RESTClient</a> library), and dynamic ability to walk JSON &amp; XML data.</p>

<p>As a review, here is our feature file, for testing a basic portion of the public Twitter API. This time around, we&rsquo;ve added a few small differences, in the treatment of querystring parameters. This is meant show that there are various ways to describe your tests, not simply monolithic URLs.</p>

<div><script src='https://gist.github.com/4582935.js'></script>
<noscript><pre><code>@Positive @Get @User
Scenario: Show twitter user
  Given I access the resource url &quot;/1/users/show.json&quot;
        And I provide parameter &quot;screen_name&quot; as &quot;jasonh_n_austin&quot;
        And I provide parameter &quot;include_entities&quot; as &quot;true&quot;
    When I retrieve the results
    Then the status code should be 200
    And it should have the field &quot;name&quot; containing the value &quot;Jason Harmon&quot;
    And it should have the field &quot;id&quot; containing the value &quot;57005215&quot;</code></pre></noscript></div>


<p>This maps to steps in our RestTests.groovy file, which utilizes the RESTClient class to manage our GET. There are plenty of options out there for a web driver, RESTClient happens to be fairly well suited for our purposes.</p>

<div><script src='https://gist.github.com/4536191.js'></script>
<noscript><pre><code>Given(~&quot;I access the resource url \&quot;([^\&quot;]*)\&quot;&quot;) { String url -&gt; 
        resp = null
        status = null

        uri = new URIBuilder(host)        
    path = url 
}

Given(~&quot;I provide parameter \&quot;([^\&quot;]*)\&quot; as \&quot;([^\&quot;]*)\&quot;&quot;) { String name, String value -&gt;
    uri.addQueryParam name, value
}

When(~&quot;I retrieve the results&quot;) { -&gt;
        try {
        restClient = new RESTClient(uri.toString())
                resp = restClient.get(path: path)
        } catch (HttpResponseException ex) {
        status = ex.getStatusCode()
    }
        if (resp != null) {
        status = resp.status
            assert ( resp.data instanceof net.sf.json.JSON )
        assert resp.data.status.size() &gt; 0
        parsed = resp.data
        }
}

Then(~&quot;the status code should be (\\d+)&quot;) { int expectedStatusCode -&gt;
    assert status == expectedStatusCode
}

Then(~&quot;it should have the field \&quot;(.*)\&quot; containing the value \&quot;(.*)\&quot;&quot;) { String field, String value -&gt;
    assert parsed.&quot;${field}&quot;.toString().equals(value) 
} </code></pre></noscript></div>


<p>Most of this code is fairly self-explanatory. For those unexposed to the wonders of Groovy JSON handling (and XML as well), the function starting with &ldquo;it should have the field&rdquo; provides some interesting syntax:</p>

<div><script src='https://gist.github.com/4582955.js'></script>
<noscript><pre><code>Then(~&quot;it should have the field \&quot;(.*)\&quot; containing the value \&quot;(.*)\&quot;&quot;) { String field, String value -&gt;
  assert parsed.&quot;${field}&quot;.toString().equals(value)   
} </code></pre></noscript></div>


<p>The &lsquo;parsed&rsquo; variable holds the parsed JSON data. As we have extracted the &lsquo;field&rsquo; variable , we can use a closure to dynamically evaluate whether that field exists in the results.</p>

<p>When we run <strong><em>&ldquo;gradle &mdash;quiet cucumber&rdquo;</em></strong>, we see the following output.</p>

<p><img src="http://res.cloudinary.com/jhrmn/image/upload/v1362658828/groovy_cucumber_twitter_lpg6yj.png" alt="" /></p>

<p>Overall, compared to either Java or C#, we end up with some very terse code using Groovy. While the difference is not stark with this very simple example, the delta will start to widen as the complexity increases, especially when complex response validation comes into play. In addition, Groovy has some great built-in libraries for building up JSON data, which can be very useful when testing PUT &amp; POST scenarios.</p>

<p>While the Gherkin syntax that SpecFlow and Cucumber-JVM share give us a fundamental link, the BDD premises in defining steps in plain English are really the most powerful aspect, regardless of technology. RESTful API testing can be very daunting with many of the commercial and open source tools available; it is my opinion that BDD/Cucumber based testing is a natural fit. Hopefully you&rsquo;ll find the same to be true after working with the examples in this article and the preceding article.</p>

<p>Happy testing!</p>
</div>


  <footer>
    <p class="meta">
      
  


  
    <span class="byline author vcard">by <a href="https://plus.google.com/111160376507741662259?rel=author"><span class="fn">jhrmn</span></a></span>
  


      








  


<time datetime="2013-01-21T00:30:27-06:00" pubdate data-updated="true">Jan 21<span>st</span>, 2013</time>
      

posted in
<span class="categories">
  
    <a class='category' href='/blog/categories/testing-automation/'>Testing Automation</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://jasonh-n-austin.github.io/2013/01/21/bdd-atdd-for-your-agile-rest-api-part-2/" data-via="jasonh_n_austin" data-counturl="http://jasonh-n-austin.github.io/2013/01/21/bdd-atdd-for-your-agile-rest-api-part-2/" >Tweet</a>
  
  
  
</div>

    
    
      <a class="pull-left" href="/2013/01/12/bdd-atdd-for-your-agile-rest-api/" title="Previous Post: BDD / ATDD for your Agile REST API">&laquo; BDD / ATDD for your Agile REST API</a>
    
    
      <a class="pull-right" href="/2013/02/14/restful-patterns-for-the-head-verb/" title="Next Post: RESTful patterns for the HEAD verb">RESTful patterns for the HEAD verb &raquo;</a>
    
  </footer>

</div>

        
          <div class="article-format">
            <h1>Comments</h1>
            <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
          </div>
        
      </article>
    </div>
  </div>
  <div id="footer-widgets">
  <div class="container">
    <div class="row">
  <div class="span3">
    <h2>recent posts</h2>
    <ul class="recent_posts">
      
        <li>
          <a href="/2013/11/10/bdd-for-apis-talk-at-apistrat-sf-2013/">BDD for APIs talk at APIStrat SF 2013</a>
        </li>
      
        <li>
          <a href="/2013/03/25/extend-your-crud-http-api-with-sub-resources/">Extend your CRUD HTTP API with sub-resources</a>
        </li>
      
        <li>
          <a href="/2013/03/06/rest-roadmap-hypermedia-for-permissions/">REST Roadmap - API Hypermedia for permissions patterns</a>
        </li>
      
        <li>
          <a href="/2013/02/28/api-makersconsumers-do-you-sometimes-feel-like-no-one-really-gets-you/">#API makers/consumers: Do you sometimes feel like no one really gets you?</a>
        </li>
      
        <li>
          <a href="/2013/02/25/api-slides-and-retros-collected-from-twitter-apistrat-nyc-2012/">API slides and retros collected from Twitter #apistrat #NYC 2013</a>
        </li>
      
    </ul>
    <h2><a href="/blog/archives">archives</a></h2>
  </div>
  <div class="span6">
    

  </div>
  <div class="span3">
    
<h2>twitter</h2>
<a href="https://twitter.com/jasonh_n_austin" class="twitter-follow-button" data-show-count="true" data-lang="en">Follow @jasonh_n_austin</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<div class="tweet" data-twitter-user="jasonh_n_austin">
</div>


  </div>
</div>

  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-left">
  <a href="/">Pragmatic API</a>
  - Copyright &copy; 2013 - Jason Harmon
</p>
<p class="pull-right">
  
    <span>Designed by <a href="http://blog.hyfather.com" target="_blank">Nikhil
  Mungel</a>. Based on <a href="https://github.com/sevenadrian/foxslide"
  target="_blank">foxslide</a>.</span><br/>
  
  <span>
    Powered by <a href="http://octopress.org/" target="_blank">Octopress</a>.
  </span>
</p>

  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script>window.jQuery || document.write('<script src="/javascripts/libs/jquery-1.7.2.min.js" type="text/javascript"><\/script>')</script>
<script src="/javascripts/libs/bootstrap.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.tweet.js" type="text/javascript"></script>
<script src="/javascripts/jquery.instagram.js" type="text/javascript"></script>
<script src="/javascripts/libs/jquery.masonry.min.js" type="text/javascript"></script>
<script src="/javascripts/custom.js" type="text/javascript"></script>


<script type="text/javascript">
      var disqus_shortname = 'pragmaticapi';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://jasonh-n-austin.github.io/2013/01/21/bdd-atdd-for-your-agile-rest-api-part-2/';
        var disqus_url = 'http://jasonh-n-austin.github.io/2013/01/21/bdd-atdd-for-your-agile-rest-api-part-2/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
